# =============================================================================
# ClassWaves Backend Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your actual values
# Created: Phase 1 Stabilization - Environment Standardization

# =============================================================================
# DATABASE & DATABRICKS
# =============================================================================
DATABRICKS_HOST=your-workspace.cloud.databricks.com
DATABRICKS_TOKEN=dapi-your-access-token
DATABRICKS_WAREHOUSE_ID=your-warehouse-id
DATABRICKS_CLUSTER_ID=your-cluster-id

# Database URL for analytics (non-STT features)
DATABASE_URL=databricks+connector://token:your-databricks-token@your-databricks-host:443/classwaves

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
# Session and JWT secrets (minimum 32 characters)
SESSION_SECRET=your-super-secure-session-secret-minimum-32-characters
JWT_SECRET=your-jwt-secret-for-token-signing
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=your-secure-refresh-token-secret-minimum-64-characters
SESSION_ENCRYPTION_SECRET=your-session-encryption-secret-minimum-64-characters

# Google OAuth for teacher authentication
GOOGLE_CLIENT_ID=your-google-oauth-client-id
GOOGLE_CLIENT_SECRET=your-google-oauth-client-secret
GOOGLE_REDIRECT_URI=http://localhost:3001/auth/callback

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
# Session storage and caching
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=your-redis-password
REDIS_POOL_SIZE=5

# =============================================================================
# OPENAI WHISPER STT CONFIGURATION
# =============================================================================
# Primary STT Provider (replaces Databricks waveWhisperer)
STT_PROVIDER=openai
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_WHISPER_TIMEOUT_MS=15000
OPENAI_WHISPER_CONCURRENCY=20
OPENAI_WHISPER_PER_SCHOOL_CONCURRENCY=5

# Audio Processing & Budget Controls
STT_WINDOW_SECONDS=15
STT_WINDOW_JITTER_MS=0
STT_BUDGET_MINUTES_PER_DAY=480
STT_BUDGET_ALERT_PCTS=75,90,100

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
# Basic server settings
NODE_ENV=development
PORT=3000

# CORS configuration
ALLOWED_ORIGINS=http://localhost:3001,http://127.0.0.1:3001

# Feature flags
ENABLE_RATE_LIMITING=true
ENABLE_DB_METRICS_PERSIST=true
HEALTH_CHECK_ENABLED=true
METRICS_COLLECTION_ENABLED=true
ALERTING_ENABLED=true

# =============================================================================
# AI ANALYSIS CONFIGURATION
# =============================================================================
# Databricks Serving Endpoints
AI_TIER1_ENDPOINT=/serving-endpoints/tier1-group-analysis/invocations
AI_TIER2_ENDPOINT=/serving-endpoints/tier2-deep-analysis/invocations
AI_TIER1_TIMEOUT_MS=15000
AI_TIER2_TIMEOUT_MS=20000
AI_TIER1_WINDOW_SECONDS=30
AI_TIER2_WINDOW_MINUTES=3
AI_TIER1_MAX_TOKENS=1000
AI_TIER2_MAX_TOKENS=2000
AI_TIER1_TEMPERATURE=0.1
AI_TIER2_TEMPERATURE=0.1
AI_RETRY_MAX_ATTEMPTS=3
AI_RETRY_BACKOFF_MS=1000
AI_RETRY_JITTER=true

# =============================================================================
# TEACHER GUIDANCE CONFIGURATION
# =============================================================================
TEACHER_GUIDANCE_ENABLED=true
TEACHER_PROMPT_MAX_PER_SESSION=15
TEACHER_PROMPT_EXPIRATION_MINUTES=30
TEACHER_PROMPT_EFFECTIVENESS_WEIGHT=0.3
TEACHER_PROMPT_SUBJECT_AWARE=true
TEACHER_PROMPT_BATCH_INTERVAL_MS=30000

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================
EMAIL_FROM=ClassWaves <noreply@classwaves.com>
GMAIL_CLIENT_ID=your-gmail-client-id
GMAIL_CLIENT_SECRET=your-gmail-client-secret
GMAIL_REFRESH_TOKEN=your-gmail-refresh-token
GMAIL_USER_EMAIL=your-gmail-user-email

# Student App Integration
STUDENT_APP_URL=http://localhost:3003

# =============================================================================
# TESTING & DEVELOPMENT
# =============================================================================
# E2E testing
E2E_TEST_SECRET=your-e2e-test-secret
DATABRICKS_WORKSPACE_URL=your-databricks-workspace-url

# Monitoring & Debugging
LOG_LEVEL=info

# =============================================================================
# CIRCUIT BREAKER & RESILIENCE
# =============================================================================
CIRCUIT_BREAKER_ENABLED=true
GOOGLE_OAUTH_TIMEOUT=5000
DATABASE_TIMEOUT=10000
REDIS_TIMEOUT=3000
